{"ast":null,"code":"import _defineProperty from \"/Users/king/playground/meetup-analyzer/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/Users/king/playground/meetup-analyzer/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport Moment from \"moment\";\nimport { extendMoment } from \"moment-range\";\nimport _ from \"lodash\"; // @ts-ignore\n\nvar moment = extendMoment(Moment);\nvar defaultAttendedMarker = \"Y\";\nvar eventDate = new Date(\"03/27/2019\");\n\nvar attendedMeetup = function attendedMeetup(user) {\n  return user.Attendance === defaultAttendedMarker ? true : false;\n};\n\nvar didRSVP = function didRSVP(user) {\n  return user.RSVP === \"Yes\" ? true : false;\n};\n\nexport var bindRawMeetupData = function bindRawMeetupData(meetupData) {\n  return meetupData.map(function (user) {\n    return {\n      userId: user[\"User ID\"] !== \"\" ? user[\"User ID\"].replace(\"user \", \"\") : null,\n      didAttend: attendedMeetup(user),\n      didRSVP: didRSVP(user),\n      title: user.Title,\n      eventHost: user[\"Event Host\"],\n      rsvpDate: user[\"RSVPed on\"] !== \"\" ? new Date(user[\"RSVPed on\"]) : null,\n      dateJoinedGroup: user[\"Joined Group on\"] ? new Date(user[\"Joined Group on\"]) : null\n    };\n  });\n};\n\nvar registeredWithin30DaysOfEvent = function registeredWithin30DaysOfEvent(dateJoined, eventDate) {\n  return moment(dateJoined).isBetween(moment(eventDate).subtract(30, \"days\"), moment(eventDate));\n};\n\nvar registeredWithinPastSixMonthsOfEvent = function registeredWithinPastSixMonthsOfEvent(dateJoined, eventDate) {\n  return moment(dateJoined).isBetween(moment(eventDate).subtract(180, \"days\"));\n};\n\nvar registeredWithinPastYearOfEvent = function registeredWithinPastYearOfEvent(dateJoined, eventDate) {\n  return moment(dateJoined).isBetween(moment(eventDate).subtract(365, \"days\"), moment(eventDate));\n};\n\nvar registeredWithinTwoYearsOfEvent = function registeredWithinTwoYearsOfEvent(dateJoined, eventDate) {\n  return moment(dateJoined).isBetween(moment(eventDate).subtract(710, \"days\"), moment(eventDate));\n};\n\nvar getRelativeRegistrationDate = function getRelativeRegistrationDate(acc, attendee, eventDate) {\n  var dateJoinedGroup = attendee.dateJoinedGroup;\n\n  if (!dateJoinedGroup) {\n    return acc;\n  }\n\n  if (registeredWithin30DaysOfEvent(dateJoinedGroup, eventDate)) {\n    return _objectSpread({}, acc, {\n      pastThirtyDays: acc.pastThirtyDays + 1\n    });\n  }\n\n  if (registeredWithinPastSixMonthsOfEvent(dateJoinedGroup, eventDate)) {\n    return _objectSpread({}, acc, {\n      pastSixMonths: acc.pastSixMonths + 1\n    });\n  }\n\n  if (registeredWithinPastYearOfEvent(dateJoinedGroup, eventDate)) {\n    return _objectSpread({}, acc, {\n      pastYear: acc.pastYear + 1\n    });\n  }\n\n  if (registeredWithinTwoYearsOfEvent(dateJoinedGroup, eventDate)) {\n    return _objectSpread({}, acc, {\n      pastTwoYears: acc.pastTwoYears + 1\n    });\n  }\n\n  return _objectSpread({}, acc, {\n    overTwoYearsAgo: acc.overTwoYearsAgo + 1\n  });\n};\n\nvar isMeetupGroupMemberAttendee = function isMeetupGroupMemberAttendee(attendee) {\n  return Boolean(attendee.didAttend && attendee.dateJoinedGroup && attendee.didRSVP);\n};\n\nvar isAttendeeWhoJoinedMeetupForEvent = function isAttendeeWhoJoinedMeetupForEvent(attendee) {\n  var rsvpDate = attendee.rsvpDate,\n      dateJoinedGroup = attendee.dateJoinedGroup,\n      didAttend = attendee.didAttend;\n  return Boolean(rsvpDate && dateJoinedGroup && didAttend && moment(rsvpDate).isSame(dateJoinedGroup, \"day\"));\n};\n\nexport var getMeetupMembersWhoAttendedSummary = function getMeetupMembersWhoAttendedSummary(attendees, eventDate) {\n  return attendees.filter(function (attendee) {\n    return isMeetupGroupMemberAttendee(attendee);\n  }).reduce(function (acc, currentAttendee) {\n    return getRelativeRegistrationDate(acc, currentAttendee, new Date(eventDate));\n  }, {\n    pastThirtyDays: 0,\n    pastSixMonths: 0,\n    pastYear: 0,\n    pastTwoYears: 0,\n    overTwoYearsAgo: 0\n  });\n};\nexport var getMeetupMembersWhoRSVPd = function getMeetupMembersWhoRSVPd(attendees, eventDate) {\n  return attendees.filter(function (attendee) {\n    return Boolean(attendee.didRSVP);\n  }).reduce(function (acc, currentAttendee) {\n    return getRelativeRegistrationDate(acc, currentAttendee, new Date(eventDate));\n  }, {\n    pastThirtyDays: 0,\n    pastSixMonths: 0,\n    pastYear: 0,\n    pastTwoYears: 0,\n    overTwoYearsAgo: 0\n  });\n};\nexport var getSummaryData = function getSummaryData(attendees) {\n  return attendees.reduce(function (acc, currentAttendee) {\n    var didRSVP = currentAttendee.didRSVP,\n        didAttend = currentAttendee.didAttend;\n    return _objectSpread({}, acc, {\n      totalCount: acc.totalCount + 1,\n      numberRSVPs: acc.numberRSVPs + (didRSVP ? 1 : 0),\n      numberAttendees: acc.numberAttendees + (didAttend ? 1 : 0),\n      attendeesWhoRSVPd: acc.attendeesWhoRSVPd + (isMeetupGroupMemberAttendee(currentAttendee) ? 1 : 0),\n      attendeesWhoJoinedMeetupForEvent: acc.attendeesWhoJoinedMeetupForEvent + (isAttendeeWhoJoinedMeetupForEvent(currentAttendee) ? 1 : 0)\n    });\n  }, {\n    totalCount: 0,\n    numberRSVPs: 0,\n    numberAttendees: 0,\n    attendeesWhoRSVPd: 0,\n    attendeesWhoJoinedMeetupForEvent: 0\n  });\n};\nexport var getFirstDay = function getFirstDay(attendees) {\n  return attendees.reduce(function (acc, attendee) {\n    return {\n      firstDate: attendee.rsvpDate && moment(attendee.rsvpDate) < acc.firstDate ? moment(attendee.rsvpDate) : acc.firstDate\n    };\n  }, {\n    firstDate: moment()\n  });\n};\n\nvar createInitialSignups = function createInitialSignups(days, firstDate) {\n  var initialSignups = {};\n\n  _.times(days + 1, function (index) {\n    var dateOfSignup = moment(firstDate).add(index, \"days\");\n    initialSignups[index] = {\n      rawDate: moment(firstDate).add(index, \"days\"),\n      count: 0\n    };\n  });\n\n  return initialSignups;\n};\n\nexport var getSignupsPerDay = function getSignupsPerDay(attendees, eventDate) {\n  var firstDay = getFirstDay(attendees).firstDate;\n  var difference = moment().range(firstDay, new Date(eventDate)).diff(\"days\");\n  console.log(\"difference\", difference);\n  var attendeesWhoRSVPd = attendees.filter(function (attendee) {\n    return attendee.didRSVP;\n  });\n  var initialSignups = createInitialSignups(difference, firstDay);\n  console.log(\"initialSignups\", initialSignups);\n  return attendeesWhoRSVPd.reduce(function (acc, attendee) {\n    var signupDate = attendee.rsvpDate && moment(attendee.rsvpDate) || moment(new Date(eventDate));\n    var daysAfterFirstDay = moment().range(firstDay, signupDate).diff(\"days\");\n    return _objectSpread({}, acc, _defineProperty({}, daysAfterFirstDay, acc[daysAfterFirstDay] ? acc[daysAfterFirstDay] + 1 : 1));\n  }, {});\n};\n\nvar getSignUpRate = function getSignUpRate() {};","map":{"version":3,"sources":["/Users/king/playground/meetup-analyzer/src/features/singleMeetingAnalysis/SingleMeetingAnalysisUtils.ts"],"names":["Moment","extendMoment","_","moment","defaultAttendedMarker","eventDate","Date","attendedMeetup","user","Attendance","didRSVP","RSVP","bindRawMeetupData","meetupData","map","userId","replace","didAttend","title","Title","eventHost","rsvpDate","dateJoinedGroup","registeredWithin30DaysOfEvent","dateJoined","isBetween","subtract","registeredWithinPastSixMonthsOfEvent","registeredWithinPastYearOfEvent","registeredWithinTwoYearsOfEvent","getRelativeRegistrationDate","acc","attendee","pastThirtyDays","pastSixMonths","pastYear","pastTwoYears","overTwoYearsAgo","isMeetupGroupMemberAttendee","Boolean","isAttendeeWhoJoinedMeetupForEvent","isSame","getMeetupMembersWhoAttendedSummary","attendees","filter","reduce","currentAttendee","getMeetupMembersWhoRSVPd","getSummaryData","totalCount","numberRSVPs","numberAttendees","attendeesWhoRSVPd","attendeesWhoJoinedMeetupForEvent","getFirstDay","firstDate","createInitialSignups","days","initialSignups","times","index","dateOfSignup","add","rawDate","count","getSignupsPerDay","firstDay","difference","range","diff","console","log","signupDate","daysAfterFirstDay","getSignUpRate"],"mappings":";;AAAA,OAAOA,MAAP,MAAmB,QAAnB;AACA,SAASC,YAAT,QAA6B,cAA7B;AACA,OAAOC,CAAP,MAAc,QAAd,C,CACA;;AACA,IAAMC,MAAM,GAAGF,YAAY,CAACD,MAAD,CAA3B;AAQA,IAAMI,qBAAqB,GAAG,GAA9B;AACA,IAAMC,SAAS,GAAG,IAAIC,IAAJ,CAAS,YAAT,CAAlB;;AAEA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,IAAD,EAA2B;AAChD,SAAOA,IAAI,CAACC,UAAL,KAAoBL,qBAApB,GAA4C,IAA5C,GAAmD,KAA1D;AACD,CAFD;;AAIA,IAAMM,OAAO,GAAG,SAAVA,OAAU,CAACF,IAAD,EAA2B;AACzC,SAAOA,IAAI,CAACG,IAAL,KAAc,KAAd,GAAsB,IAAtB,GAA6B,KAApC;AACD,CAFD;;AAIA,OAAO,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAC/BC,UAD+B,EAEZ;AACnB,SAAOA,UAAU,CAACC,GAAX,CAAe,UAACN,IAAD,EAA2B;AAC/C,WAAO;AACLO,MAAAA,MAAM,EACJP,IAAI,CAAC,SAAD,CAAJ,KAAoB,EAApB,GAAyBA,IAAI,CAAC,SAAD,CAAJ,CAAgBQ,OAAhB,CAAwB,OAAxB,EAAiC,EAAjC,CAAzB,GAAgE,IAF7D;AAGLC,MAAAA,SAAS,EAAEV,cAAc,CAACC,IAAD,CAHpB;AAILE,MAAAA,OAAO,EAAEA,OAAO,CAACF,IAAD,CAJX;AAKLU,MAAAA,KAAK,EAAEV,IAAI,CAACW,KALP;AAMLC,MAAAA,SAAS,EAAEZ,IAAI,CAAC,YAAD,CANV;AAOLa,MAAAA,QAAQ,EAAEb,IAAI,CAAC,WAAD,CAAJ,KAAsB,EAAtB,GAA2B,IAAIF,IAAJ,CAASE,IAAI,CAAC,WAAD,CAAb,CAA3B,GAAyD,IAP9D;AAQLc,MAAAA,eAAe,EAAEd,IAAI,CAAC,iBAAD,CAAJ,GACb,IAAIF,IAAJ,CAASE,IAAI,CAAC,iBAAD,CAAb,CADa,GAEb;AAVC,KAAP;AAYD,GAbM,CAAP;AAcD,CAjBM;;AAmBP,IAAMe,6BAA6B,GAAG,SAAhCA,6BAAgC,CACpCC,UADoC,EAEpCnB,SAFoC;AAAA,SAIpCF,MAAM,CAACqB,UAAD,CAAN,CAAmBC,SAAnB,CACEtB,MAAM,CAACE,SAAD,CAAN,CAAkBqB,QAAlB,CAA2B,EAA3B,EAA+B,MAA/B,CADF,EAEEvB,MAAM,CAACE,SAAD,CAFR,CAJoC;AAAA,CAAtC;;AASA,IAAMsB,oCAAoC,GAAG,SAAvCA,oCAAuC,CAC3CH,UAD2C,EAE3CnB,SAF2C;AAAA,SAI3CF,MAAM,CAACqB,UAAD,CAAN,CAAmBC,SAAnB,CAA6BtB,MAAM,CAACE,SAAD,CAAN,CAAkBqB,QAAlB,CAA2B,GAA3B,EAAgC,MAAhC,CAA7B,CAJ2C;AAAA,CAA7C;;AAMA,IAAME,+BAA+B,GAAG,SAAlCA,+BAAkC,CACtCJ,UADsC,EAEtCnB,SAFsC;AAAA,SAItCF,MAAM,CAACqB,UAAD,CAAN,CAAmBC,SAAnB,CACEtB,MAAM,CAACE,SAAD,CAAN,CAAkBqB,QAAlB,CAA2B,GAA3B,EAAgC,MAAhC,CADF,EAEEvB,MAAM,CAACE,SAAD,CAFR,CAJsC;AAAA,CAAxC;;AASA,IAAMwB,+BAA+B,GAAG,SAAlCA,+BAAkC,CACtCL,UADsC,EAEtCnB,SAFsC;AAAA,SAItCF,MAAM,CAACqB,UAAD,CAAN,CAAmBC,SAAnB,CACEtB,MAAM,CAACE,SAAD,CAAN,CAAkBqB,QAAlB,CAA2B,GAA3B,EAAgC,MAAhC,CADF,EAEEvB,MAAM,CAACE,SAAD,CAFR,CAJsC;AAAA,CAAxC;;AASA,IAAMyB,2BAA2B,GAAG,SAA9BA,2BAA8B,CAClCC,GADkC,EAElCC,QAFkC,EAGlC3B,SAHkC,EAI/B;AAAA,MACKiB,eADL,GACyBU,QADzB,CACKV,eADL;;AAEH,MAAI,CAACA,eAAL,EAAsB;AACpB,WAAOS,GAAP;AACD;;AAED,MAAIR,6BAA6B,CAACD,eAAD,EAAkBjB,SAAlB,CAAjC,EAA+D;AAC7D,6BACK0B,GADL;AAEEE,MAAAA,cAAc,EAAEF,GAAG,CAACE,cAAJ,GAAqB;AAFvC;AAID;;AAED,MAAIN,oCAAoC,CAACL,eAAD,EAAkBjB,SAAlB,CAAxC,EAAsE;AACpE,6BACK0B,GADL;AAEEG,MAAAA,aAAa,EAAEH,GAAG,CAACG,aAAJ,GAAoB;AAFrC;AAID;;AAED,MAAIN,+BAA+B,CAACN,eAAD,EAAkBjB,SAAlB,CAAnC,EAAiE;AAC/D,6BACK0B,GADL;AAEEI,MAAAA,QAAQ,EAAEJ,GAAG,CAACI,QAAJ,GAAe;AAF3B;AAID;;AAED,MAAIN,+BAA+B,CAACP,eAAD,EAAkBjB,SAAlB,CAAnC,EAAiE;AAC/D,6BACK0B,GADL;AAEEK,MAAAA,YAAY,EAAEL,GAAG,CAACK,YAAJ,GAAmB;AAFnC;AAID;;AAED,2BACKL,GADL;AAEEM,IAAAA,eAAe,EAAEN,GAAG,CAACM,eAAJ,GAAsB;AAFzC;AAID,CA1CD;;AA4CA,IAAMC,2BAA2B,GAAG,SAA9BA,2BAA8B,CAACN,QAAD;AAAA,SAClCO,OAAO,CAACP,QAAQ,CAACf,SAAT,IAAsBe,QAAQ,CAACV,eAA/B,IAAkDU,QAAQ,CAACtB,OAA5D,CAD2B;AAAA,CAApC;;AAGA,IAAM8B,iCAAiC,GAAG,SAApCA,iCAAoC,CAACR,QAAD,EAAqC;AAAA,MACrEX,QADqE,GAC5BW,QAD4B,CACrEX,QADqE;AAAA,MAC3DC,eAD2D,GAC5BU,QAD4B,CAC3DV,eAD2D;AAAA,MAC1CL,SAD0C,GAC5Be,QAD4B,CAC1Cf,SAD0C;AAE7E,SAAOsB,OAAO,CACZlB,QAAQ,IACNC,eADF,IAEEL,SAFF,IAGEd,MAAM,CAACkB,QAAD,CAAN,CAAiBoB,MAAjB,CAAwBnB,eAAxB,EAAyC,KAAzC,CAJU,CAAd;AAMD,CARD;;AAUA,OAAO,IAAMoB,kCAAkC,GAAG,SAArCA,kCAAqC,CAChDC,SADgD,EAEhDtC,SAFgD,EAGZ;AACpC,SAAOsC,SAAS,CACbC,MADI,CACG,UAAAZ,QAAQ;AAAA,WAAIM,2BAA2B,CAACN,QAAD,CAA/B;AAAA,GADX,EAEJa,MAFI,CAGH,UAACd,GAAD,EAAMe,eAAN,EAA0B;AACxB,WAAOhB,2BAA2B,CAChCC,GADgC,EAEhCe,eAFgC,EAGhC,IAAIxC,IAAJ,CAASD,SAAT,CAHgC,CAAlC;AAKD,GATE,EAUH;AACE4B,IAAAA,cAAc,EAAE,CADlB;AAEEC,IAAAA,aAAa,EAAE,CAFjB;AAGEC,IAAAA,QAAQ,EAAE,CAHZ;AAIEC,IAAAA,YAAY,EAAE,CAJhB;AAKEC,IAAAA,eAAe,EAAE;AALnB,GAVG,CAAP;AAkBD,CAtBM;AAwBP,OAAO,IAAMU,wBAAwB,GAAG,SAA3BA,wBAA2B,CACtCJ,SADsC,EAEtCtC,SAFsC,EAGF;AACpC,SAAOsC,SAAS,CACbC,MADI,CACG,UAAAZ,QAAQ;AAAA,WAAIO,OAAO,CAACP,QAAQ,CAACtB,OAAV,CAAX;AAAA,GADX,EAEJmC,MAFI,CAGH,UAACd,GAAD,EAAMe,eAAN;AAAA,WACEhB,2BAA2B,CAACC,GAAD,EAAMe,eAAN,EAAuB,IAAIxC,IAAJ,CAASD,SAAT,CAAvB,CAD7B;AAAA,GAHG,EAKH;AACE4B,IAAAA,cAAc,EAAE,CADlB;AAEEC,IAAAA,aAAa,EAAE,CAFjB;AAGEC,IAAAA,QAAQ,EAAE,CAHZ;AAIEC,IAAAA,YAAY,EAAE,CAJhB;AAKEC,IAAAA,eAAe,EAAE;AALnB,GALG,CAAP;AAaD,CAjBM;AAmBP,OAAO,IAAMW,cAAc,GAAG,SAAjBA,cAAiB,CAACL,SAAD,EAA+B;AAC3D,SAAOA,SAAS,CAACE,MAAV,CACL,UAACd,GAAD,EAAMe,eAAN,EAA0B;AAAA,QAChBpC,OADgB,GACOoC,eADP,CAChBpC,OADgB;AAAA,QACPO,SADO,GACO6B,eADP,CACP7B,SADO;AAGxB,6BACKc,GADL;AAEEkB,MAAAA,UAAU,EAAElB,GAAG,CAACkB,UAAJ,GAAiB,CAF/B;AAGEC,MAAAA,WAAW,EAAEnB,GAAG,CAACmB,WAAJ,IAAmBxC,OAAO,GAAG,CAAH,GAAO,CAAjC,CAHf;AAIEyC,MAAAA,eAAe,EAAEpB,GAAG,CAACoB,eAAJ,IAAuBlC,SAAS,GAAG,CAAH,GAAO,CAAvC,CAJnB;AAKEmC,MAAAA,iBAAiB,EACfrB,GAAG,CAACqB,iBAAJ,IACCd,2BAA2B,CAACQ,eAAD,CAA3B,GAA+C,CAA/C,GAAmD,CADpD,CANJ;AAQEO,MAAAA,gCAAgC,EAC9BtB,GAAG,CAACsB,gCAAJ,IACCb,iCAAiC,CAACM,eAAD,CAAjC,GAAqD,CAArD,GAAyD,CAD1D;AATJ;AAYD,GAhBI,EAiBL;AACEG,IAAAA,UAAU,EAAE,CADd;AAEEC,IAAAA,WAAW,EAAE,CAFf;AAGEC,IAAAA,eAAe,EAAE,CAHnB;AAIEC,IAAAA,iBAAiB,EAAE,CAJrB;AAKEC,IAAAA,gCAAgC,EAAE;AALpC,GAjBK,CAAP;AAyBD,CA1BM;AA4BP,OAAO,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACX,SAAD,EAA+B;AACxD,SAAOA,SAAS,CAACE,MAAV,CACL,UAACd,GAAD,EAAWC,QAAX,EAAsC;AACpC,WAAO;AACLuB,MAAAA,SAAS,EACPvB,QAAQ,CAACX,QAAT,IAAqBlB,MAAM,CAAC6B,QAAQ,CAACX,QAAV,CAAN,GAA4BU,GAAG,CAACwB,SAArD,GACIpD,MAAM,CAAC6B,QAAQ,CAACX,QAAV,CADV,GAEIU,GAAG,CAACwB;AAJL,KAAP;AAMD,GARI,EASL;AACEA,IAAAA,SAAS,EAAEpD,MAAM;AADnB,GATK,CAAP;AAaD,CAdM;;AAgBP,IAAMqD,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACC,IAAD,EAAeF,SAAf,EAAkC;AAC7D,MAAIG,cAAmB,GAAG,EAA1B;;AACAxD,EAAAA,CAAC,CAACyD,KAAF,CAAQF,IAAI,GAAG,CAAf,EAAkB,UAAAG,KAAK,EAAI;AACzB,QAAMC,YAAY,GAAG1D,MAAM,CAACoD,SAAD,CAAN,CAAkBO,GAAlB,CAAsBF,KAAtB,EAA6B,MAA7B,CAArB;AACAF,IAAAA,cAAc,CAACE,KAAD,CAAd,GAAwB;AACtBG,MAAAA,OAAO,EAAE5D,MAAM,CAACoD,SAAD,CAAN,CAAkBO,GAAlB,CAAsBF,KAAtB,EAA6B,MAA7B,CADa;AAEtBI,MAAAA,KAAK,EAAE;AAFe,KAAxB;AAID,GAND;;AAQA,SAAON,cAAP;AACD,CAXD;;AAaA,OAAO,IAAMO,gBAAgB,GAAG,SAAnBA,gBAAmB,CAC9BtB,SAD8B,EAE9BtC,SAF8B,EAG3B;AACH,MAAM6D,QAAQ,GAAGZ,WAAW,CAACX,SAAD,CAAX,CAAuBY,SAAxC;AACA,MAAMY,UAAU,GAAGhE,MAAM,GACtBiE,KADgB,CACVF,QADU,EACA,IAAI5D,IAAJ,CAASD,SAAT,CADA,EAEhBgE,IAFgB,CAEX,MAFW,CAAnB;AAGAC,EAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BJ,UAA1B;AAEA,MAAMf,iBAAiB,GAAGT,SAAS,CAACC,MAAV,CAAiB,UAAAZ,QAAQ;AAAA,WAAIA,QAAQ,CAACtB,OAAb;AAAA,GAAzB,CAA1B;AAEA,MAAMgD,cAAc,GAAGF,oBAAoB,CAACW,UAAD,EAAaD,QAAb,CAA3C;AACAI,EAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8Bb,cAA9B;AACA,SAAON,iBAAiB,CAACP,MAAlB,CAAyB,UAACd,GAAD,EAAWC,QAAX,EAAsC;AACpE,QAAMwC,UAAU,GACbxC,QAAQ,CAACX,QAAT,IAAqBlB,MAAM,CAAC6B,QAAQ,CAACX,QAAV,CAA5B,IACAlB,MAAM,CAAC,IAAIG,IAAJ,CAASD,SAAT,CAAD,CAFR;AAIA,QAAMoE,iBAAiB,GAAGtE,MAAM,GAC7BiE,KADuB,CACjBF,QADiB,EACPM,UADO,EAEvBH,IAFuB,CAElB,MAFkB,CAA1B;AAGA,6BACKtC,GADL,sBAEG0C,iBAFH,EAEuB1C,GAAG,CAAC0C,iBAAD,CAAH,GACjB1C,GAAG,CAAC0C,iBAAD,CAAH,GAAyB,CADR,GAEjB,CAJN;AAMD,GAdM,EAcJ,EAdI,CAAP;AAeD,CA7BM;;AA+BP,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,GAAM,CAAE,CAA9B","sourcesContent":["import Moment from \"moment\";\nimport { extendMoment } from \"moment-range\";\nimport _ from \"lodash\";\n// @ts-ignore\nconst moment = extendMoment(Moment);\n\nimport {\n  RawAttendeeData,\n  AttendeeData,\n  RelativeMeetupRegistrationDates\n} from \"./SingleMeetupTypes\";\n\nconst defaultAttendedMarker = \"Y\";\nconst eventDate = new Date(\"03/27/2019\");\n\nconst attendedMeetup = (user: RawAttendeeData) => {\n  return user.Attendance === defaultAttendedMarker ? true : false;\n};\n\nconst didRSVP = (user: RawAttendeeData) => {\n  return user.RSVP === \"Yes\" ? true : false;\n};\n\nexport const bindRawMeetupData = (\n  meetupData: RawAttendeeData[]\n): AttendeeData[] => {\n  return meetupData.map((user: RawAttendeeData) => {\n    return {\n      userId:\n        user[\"User ID\"] !== \"\" ? user[\"User ID\"].replace(\"user \", \"\") : null,\n      didAttend: attendedMeetup(user),\n      didRSVP: didRSVP(user),\n      title: user.Title,\n      eventHost: user[\"Event Host\"],\n      rsvpDate: user[\"RSVPed on\"] !== \"\" ? new Date(user[\"RSVPed on\"]) : null,\n      dateJoinedGroup: user[\"Joined Group on\"]\n        ? new Date(user[\"Joined Group on\"])\n        : null\n    };\n  });\n};\n\nconst registeredWithin30DaysOfEvent = (\n  dateJoined: Date,\n  eventDate: Date\n): boolean =>\n  moment(dateJoined).isBetween(\n    moment(eventDate).subtract(30, \"days\"),\n    moment(eventDate)\n  );\n\nconst registeredWithinPastSixMonthsOfEvent = (\n  dateJoined: Date,\n  eventDate: Date\n): boolean =>\n  moment(dateJoined).isBetween(moment(eventDate).subtract(180, \"days\"));\n\nconst registeredWithinPastYearOfEvent = (\n  dateJoined: Date,\n  eventDate: Date\n): boolean =>\n  moment(dateJoined).isBetween(\n    moment(eventDate).subtract(365, \"days\"),\n    moment(eventDate)\n  );\n\nconst registeredWithinTwoYearsOfEvent = (\n  dateJoined: Date,\n  eventDate: Date\n): boolean =>\n  moment(dateJoined).isBetween(\n    moment(eventDate).subtract(710, \"days\"),\n    moment(eventDate)\n  );\n\nconst getRelativeRegistrationDate = (\n  acc: RelativeMeetupRegistrationDates,\n  attendee: AttendeeData,\n  eventDate: Date\n) => {\n  const { dateJoinedGroup } = attendee;\n  if (!dateJoinedGroup) {\n    return acc;\n  }\n\n  if (registeredWithin30DaysOfEvent(dateJoinedGroup, eventDate)) {\n    return {\n      ...acc,\n      pastThirtyDays: acc.pastThirtyDays + 1\n    };\n  }\n\n  if (registeredWithinPastSixMonthsOfEvent(dateJoinedGroup, eventDate)) {\n    return {\n      ...acc,\n      pastSixMonths: acc.pastSixMonths + 1\n    };\n  }\n\n  if (registeredWithinPastYearOfEvent(dateJoinedGroup, eventDate)) {\n    return {\n      ...acc,\n      pastYear: acc.pastYear + 1\n    };\n  }\n\n  if (registeredWithinTwoYearsOfEvent(dateJoinedGroup, eventDate)) {\n    return {\n      ...acc,\n      pastTwoYears: acc.pastTwoYears + 1\n    };\n  }\n\n  return {\n    ...acc,\n    overTwoYearsAgo: acc.overTwoYearsAgo + 1\n  };\n};\n\nconst isMeetupGroupMemberAttendee = (attendee: AttendeeData): boolean =>\n  Boolean(attendee.didAttend && attendee.dateJoinedGroup && attendee.didRSVP);\n\nconst isAttendeeWhoJoinedMeetupForEvent = (attendee: AttendeeData): boolean => {\n  const { rsvpDate, dateJoinedGroup, didAttend } = attendee;\n  return Boolean(\n    rsvpDate &&\n      dateJoinedGroup &&\n      didAttend &&\n      moment(rsvpDate).isSame(dateJoinedGroup, \"day\")\n  );\n};\n\nexport const getMeetupMembersWhoAttendedSummary = (\n  attendees: AttendeeData[],\n  eventDate: string\n): RelativeMeetupRegistrationDates => {\n  return attendees\n    .filter(attendee => isMeetupGroupMemberAttendee(attendee))\n    .reduce(\n      (acc, currentAttendee) => {\n        return getRelativeRegistrationDate(\n          acc,\n          currentAttendee,\n          new Date(eventDate)\n        );\n      },\n      {\n        pastThirtyDays: 0,\n        pastSixMonths: 0,\n        pastYear: 0,\n        pastTwoYears: 0,\n        overTwoYearsAgo: 0\n      }\n    );\n};\n\nexport const getMeetupMembersWhoRSVPd = (\n  attendees: AttendeeData[],\n  eventDate: string\n): RelativeMeetupRegistrationDates => {\n  return attendees\n    .filter(attendee => Boolean(attendee.didRSVP))\n    .reduce(\n      (acc, currentAttendee) =>\n        getRelativeRegistrationDate(acc, currentAttendee, new Date(eventDate)),\n      {\n        pastThirtyDays: 0,\n        pastSixMonths: 0,\n        pastYear: 0,\n        pastTwoYears: 0,\n        overTwoYearsAgo: 0\n      }\n    );\n};\n\nexport const getSummaryData = (attendees: AttendeeData[]) => {\n  return attendees.reduce(\n    (acc, currentAttendee) => {\n      const { didRSVP, didAttend } = currentAttendee;\n\n      return {\n        ...acc,\n        totalCount: acc.totalCount + 1,\n        numberRSVPs: acc.numberRSVPs + (didRSVP ? 1 : 0),\n        numberAttendees: acc.numberAttendees + (didAttend ? 1 : 0),\n        attendeesWhoRSVPd:\n          acc.attendeesWhoRSVPd +\n          (isMeetupGroupMemberAttendee(currentAttendee) ? 1 : 0),\n        attendeesWhoJoinedMeetupForEvent:\n          acc.attendeesWhoJoinedMeetupForEvent +\n          (isAttendeeWhoJoinedMeetupForEvent(currentAttendee) ? 1 : 0)\n      };\n    },\n    {\n      totalCount: 0,\n      numberRSVPs: 0,\n      numberAttendees: 0,\n      attendeesWhoRSVPd: 0,\n      attendeesWhoJoinedMeetupForEvent: 0\n    }\n  );\n};\n\nexport const getFirstDay = (attendees: AttendeeData[]) => {\n  return attendees.reduce(\n    (acc: any, attendee: AttendeeData) => {\n      return {\n        firstDate:\n          attendee.rsvpDate && moment(attendee.rsvpDate) < acc.firstDate\n            ? moment(attendee.rsvpDate)\n            : acc.firstDate\n      };\n    },\n    {\n      firstDate: moment()\n    }\n  );\n};\n\nconst createInitialSignups = (days: number, firstDate: any) => {\n  let initialSignups: any = {};\n  _.times(days + 1, index => {\n    const dateOfSignup = moment(firstDate).add(index, \"days\");\n    initialSignups[index] = {\n      rawDate: moment(firstDate).add(index, \"days\"),\n      count: 0\n    };\n  });\n\n  return initialSignups;\n};\n\nexport const getSignupsPerDay = (\n  attendees: AttendeeData[],\n  eventDate: string\n) => {\n  const firstDay = getFirstDay(attendees).firstDate;\n  const difference = moment()\n    .range(firstDay, new Date(eventDate))\n    .diff(\"days\");\n  console.log(\"difference\", difference);\n\n  const attendeesWhoRSVPd = attendees.filter(attendee => attendee.didRSVP);\n\n  const initialSignups = createInitialSignups(difference, firstDay);\n  console.log(\"initialSignups\", initialSignups);\n  return attendeesWhoRSVPd.reduce((acc: any, attendee: AttendeeData) => {\n    const signupDate =\n      (attendee.rsvpDate && moment(attendee.rsvpDate)) ||\n      moment(new Date(eventDate));\n\n    const daysAfterFirstDay = moment()\n      .range(firstDay, signupDate)\n      .diff(\"days\");\n    return {\n      ...acc,\n      [daysAfterFirstDay]: acc[daysAfterFirstDay]\n        ? acc[daysAfterFirstDay] + 1\n        : 1\n    };\n  }, {});\n};\n\nconst getSignUpRate = () => {};\n"]},"metadata":{},"sourceType":"module"}