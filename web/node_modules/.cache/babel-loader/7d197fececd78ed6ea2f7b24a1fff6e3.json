{"ast":null,"code":"import _defineProperty from \"/Users/king/playground/meetup-analyzer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/Users/king/playground/meetup-analyzer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/king/playground/meetup-analyzer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport Moment from \"moment\";\nimport { extendMoment } from \"moment-range\";\nimport _ from \"lodash\";\n// @ts-ignore\nvar moment = extendMoment(Moment);\nvar defaultAttendedMarker = \"Y\";\n\nvar attendedMeetup = function attendedMeetup(user) {\n  return user.Attendance === defaultAttendedMarker ? true : false;\n};\n\nvar didRSVP = function didRSVP(user) {\n  return user.RSVP === \"Yes\" ? true : false;\n};\n\nexport var bindRawMeetupData = function bindRawMeetupData(meetupData) {\n  return meetupData.map(function (user) {\n    return {\n      userId: user[\"User ID\"] !== \"\" ? user[\"User ID\"].replace(\"user \", \"\") : null,\n      didAttend: attendedMeetup(user),\n      didRSVP: didRSVP(user),\n      title: user.Title,\n      eventHost: user[\"Event Host\"],\n      rsvpDate: user[\"RSVPed on\"] !== \"\" ? new Date(user[\"RSVPed on\"]) : null,\n      dateJoinedGroup: user[\"Joined Group on\"] ? new Date(user[\"Joined Group on\"]) : null\n    };\n  });\n};\nexport var getMeetupUserIds = function getMeetupUserIds(meetupData) {\n  var userIds = meetupData.map(function (attendee) {\n    return attendee && attendee.userId || null;\n  }).filter(function (id) {\n    return id !== null;\n  });\n  return userIds.filter(Boolean);\n};\n\nvar registeredWithin30DaysOfEvent = function registeredWithin30DaysOfEvent(dateJoined, eventDate) {\n  return moment(dateJoined).isBetween(moment(eventDate).subtract(30, \"days\"), moment(eventDate));\n};\n\nvar registeredWithinPastSixMonthsOfEvent = function registeredWithinPastSixMonthsOfEvent(dateJoined, eventDate) {\n  return moment(dateJoined).isBetween(moment(eventDate).subtract(180, \"days\"));\n};\n\nvar registeredWithinPastYearOfEvent = function registeredWithinPastYearOfEvent(dateJoined, eventDate) {\n  return moment(dateJoined).isBetween(moment(eventDate).subtract(365, \"days\"), moment(eventDate));\n};\n\nvar registeredWithinTwoYearsOfEvent = function registeredWithinTwoYearsOfEvent(dateJoined, eventDate) {\n  return moment(dateJoined).isBetween(moment(eventDate).subtract(710, \"days\"), moment(eventDate));\n};\n\nvar getRelativeRegistrationDate = function getRelativeRegistrationDate(acc, attendee, eventDate) {\n  var dateJoinedGroup = attendee.dateJoinedGroup;\n\n  if (!dateJoinedGroup) {\n    return acc;\n  }\n\n  if (registeredWithin30DaysOfEvent(dateJoinedGroup, eventDate)) {\n    return _objectSpread({}, acc, {\n      pastThirtyDays: acc.pastThirtyDays + 1\n    });\n  }\n\n  if (registeredWithinPastSixMonthsOfEvent(dateJoinedGroup, eventDate)) {\n    return _objectSpread({}, acc, {\n      pastSixMonths: acc.pastSixMonths + 1\n    });\n  }\n\n  if (registeredWithinPastYearOfEvent(dateJoinedGroup, eventDate)) {\n    return _objectSpread({}, acc, {\n      pastYear: acc.pastYear + 1\n    });\n  }\n\n  if (registeredWithinTwoYearsOfEvent(dateJoinedGroup, eventDate)) {\n    return _objectSpread({}, acc, {\n      pastTwoYears: acc.pastTwoYears + 1\n    });\n  }\n\n  return _objectSpread({}, acc, {\n    overTwoYearsAgo: acc.overTwoYearsAgo + 1\n  });\n};\n\nvar isMeetupGroupMemberAttendee = function isMeetupGroupMemberAttendee(attendee) {\n  return Boolean(attendee.didAttend && attendee.dateJoinedGroup && attendee.didRSVP);\n};\n\nvar isAttendeeWhoJoinedMeetupForEvent = function isAttendeeWhoJoinedMeetupForEvent(attendee) {\n  var rsvpDate = attendee.rsvpDate,\n      dateJoinedGroup = attendee.dateJoinedGroup,\n      didAttend = attendee.didAttend;\n  return Boolean(rsvpDate && dateJoinedGroup && didAttend && moment(rsvpDate).isSame(dateJoinedGroup, \"day\"));\n};\n\nexport var getMeetupMembersWhoAttendedSummary = function getMeetupMembersWhoAttendedSummary(attendees, eventDate) {\n  return attendees.filter(function (attendee) {\n    return isMeetupGroupMemberAttendee(attendee);\n  }).reduce(function (acc, currentAttendee) {\n    return getRelativeRegistrationDate(acc, currentAttendee, new Date(eventDate));\n  }, {\n    pastThirtyDays: 0,\n    pastSixMonths: 0,\n    pastYear: 0,\n    pastTwoYears: 0,\n    overTwoYearsAgo: 0\n  });\n};\nexport var getMeetupMembersWhoRSVPd = function getMeetupMembersWhoRSVPd(attendees, eventDate) {\n  return attendees.filter(function (attendee) {\n    return Boolean(attendee.didRSVP);\n  }).reduce(function (acc, currentAttendee) {\n    return getRelativeRegistrationDate(acc, currentAttendee, new Date(eventDate));\n  }, {\n    pastThirtyDays: 0,\n    pastSixMonths: 0,\n    pastYear: 0,\n    pastTwoYears: 0,\n    overTwoYearsAgo: 0\n  });\n};\nexport var getSummaryData = function getSummaryData(attendees) {\n  return attendees.reduce(function (acc, currentAttendee) {\n    var didRSVP = currentAttendee.didRSVP,\n        didAttend = currentAttendee.didAttend;\n    return _objectSpread({}, acc, {\n      totalCount: acc.totalCount + 1,\n      numberRSVPs: acc.numberRSVPs + (didRSVP ? 1 : 0),\n      numberAttendees: acc.numberAttendees + (didAttend ? 1 : 0),\n      attendeesWhoRSVPd: acc.attendeesWhoRSVPd + (isMeetupGroupMemberAttendee(currentAttendee) ? 1 : 0),\n      attendeesWhoJoinedMeetupForEvent: acc.attendeesWhoJoinedMeetupForEvent + (isAttendeeWhoJoinedMeetupForEvent(currentAttendee) ? 1 : 0)\n    });\n  }, {\n    totalCount: 0,\n    numberRSVPs: 0,\n    numberAttendees: 0,\n    attendeesWhoRSVPd: 0,\n    attendeesWhoJoinedMeetupForEvent: 0\n  });\n};\n\nvar getFirstDateAttendeeSignedUp = function getFirstDateAttendeeSignedUp(attendees) {\n  return attendees.reduce(function (earliestDate, attendee) {\n    var momentStartDate = attendee.rsvpDate && moment(attendee.rsvpDate) < earliestDate ? moment(attendee.rsvpDate).startOf(\"day\") : earliestDate;\n    return momentStartDate;\n  }, moment());\n}; // TODO: Type this better\n\n\nvar weekdayNumberToTextMap = {\n  0: \"Sun\",\n  1: \"Mon\",\n  2: \"Tue\",\n  3: \"Wed\",\n  4: \"Thu\",\n  5: \"Fri\",\n  6: \"Sat\"\n};\n\nvar createInitialSignups = function createInitialSignups(days, firstDate) {\n  var initialSignups = {};\n\n  _.times(days + 1, function (index) {\n    var dateOfSignup = moment(firstDate).add(index, \"days\");\n    var dayOfWeek = weekdayNumberToTextMap[dateOfSignup.day()];\n    var displayDate = \"\".concat(dateOfSignup.month() + 1, \"/\").concat(dateOfSignup.date());\n    initialSignups[index] = {\n      daysSinceFirstSignupDay: index,\n      rawDate: dateOfSignup,\n      count: 0,\n      dayOfWeek: dayOfWeek,\n      displayDate: displayDate,\n      attendees: []\n    };\n  });\n\n  return initialSignups;\n};\n\nexport var getSignupsPerDay = function getSignupsPerDay(attendees, eventDate) {\n  var firstDate = getFirstDateAttendeeSignedUp(attendees);\n  var difference = moment().range(firstDate.startOf(\"day\"), moment(eventDate).startOf(\"day\")).diff(\"days\");\n  var attendeesWhoRSVPd = attendees.filter(function (attendee) {\n    return attendee.didRSVP;\n  });\n  var initialSignups = createInitialSignups(difference, firstDate);\n  return attendeesWhoRSVPd.reduce(function (acc, attendee) {\n    var signupDate = attendee.rsvpDate && moment(attendee.rsvpDate) || moment(eventDate);\n    var daysAfterFirstDay = moment().range(moment(firstDate).startOf(\"day\"), moment(signupDate).startOf(\"day\")).diff(\"days\");\n    return _objectSpread({}, acc, _defineProperty({}, daysAfterFirstDay, _objectSpread({}, acc[daysAfterFirstDay], {\n      count: acc[daysAfterFirstDay].count + 1,\n      attendees: [].concat(_toConsumableArray(acc[daysAfterFirstDay].attendees), [attendee])\n    })));\n  }, initialSignups);\n};\nexport var getSignupsAccumulated = function getSignupsAccumulated(attendees, eventDate) {\n  var signupsPerDay = getSignupsPerDay(attendees, eventDate);\n\n  var signupsAfterFirstDay = _.omit(signupsPerDay, \"0\");\n\n  var accumulatedSignUpsPerDay = _.reduce(signupsAfterFirstDay, function (acc, day) {\n    return _objectSpread({}, acc, _defineProperty({}, day.daysSinceFirstSignupDay, _objectSpread({}, day, {\n      // @ts-ignore\n      count: day.count + acc[day.daysSinceFirstSignupDay - 1].count\n    })));\n  }, {\n    0: signupsPerDay[\"0\"]\n  });\n\n  return accumulatedSignUpsPerDay;\n};\nexport var getAttendanceRateBySignupDate = function getAttendanceRateBySignupDate(attendees, eventDate) {\n  var signupsPerDay = getSignupsPerDay(attendees, eventDate);\n  return _.reduce(signupsPerDay, function (days, value, key) {\n    var attendees = value.attendees;\n    var initialCounts = {\n      rsvped: 0,\n      attended: 0\n    };\n    var attendeeSummaryPerDay = attendees.reduce(function (attendeeCounts, attendee) {\n      return _objectSpread({}, attendeeCounts, {\n        rsvped: attendeeCounts.rsvped + 1,\n        attended: attendee.didAttend ? attendeeCounts.attended + 1 : attendeeCounts.attended\n      });\n    }, initialCounts);\n    return _objectSpread({}, days, _defineProperty({}, key, _objectSpread({}, attendeeSummaryPerDay, {\n      displayDate: value.displayDate\n    })));\n  }, {});\n};\n\nvar sumAttendanceRates = function sumAttendanceRates(attendance, value) {\n  return {\n    rsvped: attendance.rsvped + value.rsvped,\n    attended: attendance.attended + value.attended\n  };\n};\n\nexport var getFirstWeekSignups = function getFirstWeekSignups(attendanceRateBySignupDate) {\n  if (_.size(attendanceRateBySignupDate) < 7) {\n    return null;\n  }\n\n  var firstWeekAttendanceRate = _.filter(attendanceRateBySignupDate, function (value, key) {\n    var daysAfterFirstDay = parseInt(key);\n    return daysAfterFirstDay > 0 && daysAfterFirstDay < 7;\n  }); // @ts-ignore\n\n\n  return _.reduce(firstWeekAttendanceRate, sumAttendanceRates, {\n    rsvped: 0,\n    attended: 0\n  });\n};\nexport var getLastWeekSignups = function getLastWeekSignups(attendanceRateBySignupDate) {\n  var totalDays = _.size(attendanceRateBySignupDate);\n\n  if (totalDays < 7) {\n    return null;\n  }\n\n  var lastDay = totalDays - 1;\n\n  var firstWeekAttendanceRate = _.filter(attendanceRateBySignupDate, function (value, key) {\n    var daysAfterFirstDay = parseInt(key);\n    return daysAfterFirstDay > lastDay - 7;\n  }); // @ts-ignore\n\n\n  return _.reduce(firstWeekAttendanceRate, sumAttendanceRates, {\n    rsvped: 0,\n    attended: 0\n  });\n};\nexport var getAttendeesBySignupDateTable = function getAttendeesBySignupDateTable(attendanceRateBySignupDate) {\n  return _.map(attendanceRateBySignupDate, function (date) {\n    return _objectSpread({}, date, {\n      percent: Math.round(date.attended / date.rsvped * 100)\n    });\n  }).filter(function (date) {\n    return date.rsvped >= 5;\n  }).sort();\n};","map":{"version":3,"sources":["/Users/king/playground/meetup-analyzer/src/features/singleMeetingAnalysis/SingleMeetingAnalysisUtils.ts"],"names":["Moment","extendMoment","_","moment","defaultAttendedMarker","attendedMeetup","user","Attendance","didRSVP","RSVP","bindRawMeetupData","meetupData","map","userId","replace","didAttend","title","Title","eventHost","rsvpDate","Date","dateJoinedGroup","getMeetupUserIds","userIds","attendee","filter","id","Boolean","registeredWithin30DaysOfEvent","dateJoined","eventDate","isBetween","subtract","registeredWithinPastSixMonthsOfEvent","registeredWithinPastYearOfEvent","registeredWithinTwoYearsOfEvent","getRelativeRegistrationDate","acc","pastThirtyDays","pastSixMonths","pastYear","pastTwoYears","overTwoYearsAgo","isMeetupGroupMemberAttendee","isAttendeeWhoJoinedMeetupForEvent","isSame","getMeetupMembersWhoAttendedSummary","attendees","reduce","currentAttendee","getMeetupMembersWhoRSVPd","getSummaryData","totalCount","numberRSVPs","numberAttendees","attendeesWhoRSVPd","attendeesWhoJoinedMeetupForEvent","getFirstDateAttendeeSignedUp","earliestDate","momentStartDate","startOf","weekdayNumberToTextMap","createInitialSignups","days","firstDate","initialSignups","times","index","dateOfSignup","add","dayOfWeek","day","displayDate","month","date","daysSinceFirstSignupDay","rawDate","count","getSignupsPerDay","difference","range","diff","signupDate","daysAfterFirstDay","getSignupsAccumulated","signupsPerDay","signupsAfterFirstDay","omit","accumulatedSignUpsPerDay","getAttendanceRateBySignupDate","value","key","initialCounts","rsvped","attended","attendeeSummaryPerDay","attendeeCounts","sumAttendanceRates","attendance","getFirstWeekSignups","attendanceRateBySignupDate","size","firstWeekAttendanceRate","parseInt","getLastWeekSignups","totalDays","lastDay","getAttendeesBySignupDateTable","percent","Math","round","sort"],"mappings":"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","sourcesContent":["import Moment from \"moment\";\nimport { extendMoment } from \"moment-range\";\nimport _ from \"lodash\";\n\nimport {\n  RawAttendeeData,\n  AttendeeData,\n  RelativeMeetupRegistrationDates,\n  AttendeeCountsForDate,\n  AttendanceRateBySignupDate,\n  AttendanceBySignupDateForTable\n} from \"./SingleMeetupTypes\";\n\n// @ts-ignore\nconst moment = extendMoment(Moment);\nconst defaultAttendedMarker = \"Y\";\n\nconst attendedMeetup = (user: RawAttendeeData) => {\n  return user.Attendance === defaultAttendedMarker ? true : false;\n};\n\nconst didRSVP = (user: RawAttendeeData) => {\n  return user.RSVP === \"Yes\" ? true : false;\n};\n\nexport const bindRawMeetupData = (\n  meetupData: RawAttendeeData[]\n): AttendeeData[] => {\n  return meetupData.map((user: RawAttendeeData) => {\n    return {\n      userId:\n        user[\"User ID\"] !== \"\" ? user[\"User ID\"].replace(\"user \", \"\") : null,\n      didAttend: attendedMeetup(user),\n      didRSVP: didRSVP(user),\n      title: user.Title,\n      eventHost: user[\"Event Host\"],\n      rsvpDate: user[\"RSVPed on\"] !== \"\" ? new Date(user[\"RSVPed on\"]) : null,\n      dateJoinedGroup: user[\"Joined Group on\"]\n        ? new Date(user[\"Joined Group on\"])\n        : null\n    };\n  });\n};\n\nexport const getMeetupUserIds = (meetupData: AttendeeData[]): string[] => {\n  const userIds = meetupData\n    .map((attendee: AttendeeData) => {\n      return (attendee && attendee.userId) || null;\n    })\n    .filter(id => id !== null);\n\n  return userIds.filter(Boolean);\n};\n\nconst registeredWithin30DaysOfEvent = (\n  dateJoined: Date,\n  eventDate: Date\n): boolean =>\n  moment(dateJoined).isBetween(\n    moment(eventDate).subtract(30, \"days\"),\n    moment(eventDate)\n  );\n\nconst registeredWithinPastSixMonthsOfEvent = (\n  dateJoined: Date,\n  eventDate: Date\n): boolean =>\n  moment(dateJoined).isBetween(moment(eventDate).subtract(180, \"days\"));\n\nconst registeredWithinPastYearOfEvent = (\n  dateJoined: Date,\n  eventDate: Date\n): boolean =>\n  moment(dateJoined).isBetween(\n    moment(eventDate).subtract(365, \"days\"),\n    moment(eventDate)\n  );\n\nconst registeredWithinTwoYearsOfEvent = (\n  dateJoined: Date,\n  eventDate: Date\n): boolean =>\n  moment(dateJoined).isBetween(\n    moment(eventDate).subtract(710, \"days\"),\n    moment(eventDate)\n  );\n\nconst getRelativeRegistrationDate = (\n  acc: RelativeMeetupRegistrationDates,\n  attendee: AttendeeData,\n  eventDate: Date\n) => {\n  const { dateJoinedGroup } = attendee;\n  if (!dateJoinedGroup) {\n    return acc;\n  }\n\n  if (registeredWithin30DaysOfEvent(dateJoinedGroup, eventDate)) {\n    return {\n      ...acc,\n      pastThirtyDays: acc.pastThirtyDays + 1\n    };\n  }\n\n  if (registeredWithinPastSixMonthsOfEvent(dateJoinedGroup, eventDate)) {\n    return {\n      ...acc,\n      pastSixMonths: acc.pastSixMonths + 1\n    };\n  }\n\n  if (registeredWithinPastYearOfEvent(dateJoinedGroup, eventDate)) {\n    return {\n      ...acc,\n      pastYear: acc.pastYear + 1\n    };\n  }\n\n  if (registeredWithinTwoYearsOfEvent(dateJoinedGroup, eventDate)) {\n    return {\n      ...acc,\n      pastTwoYears: acc.pastTwoYears + 1\n    };\n  }\n\n  return {\n    ...acc,\n    overTwoYearsAgo: acc.overTwoYearsAgo + 1\n  };\n};\n\nconst isMeetupGroupMemberAttendee = (attendee: AttendeeData): boolean =>\n  Boolean(attendee.didAttend && attendee.dateJoinedGroup && attendee.didRSVP);\n\nconst isAttendeeWhoJoinedMeetupForEvent = (attendee: AttendeeData): boolean => {\n  const { rsvpDate, dateJoinedGroup, didAttend } = attendee;\n  return Boolean(\n    rsvpDate &&\n      dateJoinedGroup &&\n      didAttend &&\n      moment(rsvpDate).isSame(dateJoinedGroup, \"day\")\n  );\n};\n\nexport const getMeetupMembersWhoAttendedSummary = (\n  attendees: AttendeeData[],\n  eventDate: string\n): RelativeMeetupRegistrationDates => {\n  return attendees\n    .filter(attendee => isMeetupGroupMemberAttendee(attendee))\n    .reduce(\n      (acc, currentAttendee) => {\n        return getRelativeRegistrationDate(\n          acc,\n          currentAttendee,\n          new Date(eventDate)\n        );\n      },\n      {\n        pastThirtyDays: 0,\n        pastSixMonths: 0,\n        pastYear: 0,\n        pastTwoYears: 0,\n        overTwoYearsAgo: 0\n      }\n    );\n};\n\nexport const getMeetupMembersWhoRSVPd = (\n  attendees: AttendeeData[],\n  eventDate: string\n): RelativeMeetupRegistrationDates => {\n  return attendees\n    .filter(attendee => Boolean(attendee.didRSVP))\n    .reduce(\n      (acc, currentAttendee) =>\n        getRelativeRegistrationDate(acc, currentAttendee, new Date(eventDate)),\n      {\n        pastThirtyDays: 0,\n        pastSixMonths: 0,\n        pastYear: 0,\n        pastTwoYears: 0,\n        overTwoYearsAgo: 0\n      }\n    );\n};\n\nexport const getSummaryData = (attendees: AttendeeData[]) => {\n  return attendees.reduce(\n    (acc, currentAttendee) => {\n      const { didRSVP, didAttend } = currentAttendee;\n\n      return {\n        ...acc,\n        totalCount: acc.totalCount + 1,\n        numberRSVPs: acc.numberRSVPs + (didRSVP ? 1 : 0),\n        numberAttendees: acc.numberAttendees + (didAttend ? 1 : 0),\n        attendeesWhoRSVPd:\n          acc.attendeesWhoRSVPd +\n          (isMeetupGroupMemberAttendee(currentAttendee) ? 1 : 0),\n        attendeesWhoJoinedMeetupForEvent:\n          acc.attendeesWhoJoinedMeetupForEvent +\n          (isAttendeeWhoJoinedMeetupForEvent(currentAttendee) ? 1 : 0)\n      };\n    },\n    {\n      totalCount: 0,\n      numberRSVPs: 0,\n      numberAttendees: 0,\n      attendeesWhoRSVPd: 0,\n      attendeesWhoJoinedMeetupForEvent: 0\n    }\n  );\n};\n\nconst getFirstDateAttendeeSignedUp = (attendees: AttendeeData[]) => {\n  return attendees.reduce((earliestDate: any, attendee: AttendeeData) => {\n    const momentStartDate =\n      attendee.rsvpDate && moment(attendee.rsvpDate) < earliestDate\n        ? moment(attendee.rsvpDate).startOf(\"day\")\n        : earliestDate;\n    return momentStartDate;\n  }, moment());\n};\n\n// TODO: Type this better\nconst weekdayNumberToTextMap: any = {\n  0: \"Sun\",\n  1: \"Mon\",\n  2: \"Tue\",\n  3: \"Wed\",\n  4: \"Thu\",\n  5: \"Fri\",\n  6: \"Sat\"\n};\n\nconst createInitialSignups = (days: number, firstDate: any) => {\n  let initialSignups: any = {};\n  _.times(days + 1, index => {\n    const dateOfSignup = moment(firstDate).add(index, \"days\");\n    const dayOfWeek = weekdayNumberToTextMap[dateOfSignup.day()];\n\n    const displayDate = `${dateOfSignup.month() + 1}/${dateOfSignup.date()}`;\n\n    initialSignups[index] = {\n      daysSinceFirstSignupDay: index,\n      rawDate: dateOfSignup,\n      count: 0,\n      dayOfWeek,\n      displayDate,\n      attendees: []\n    };\n  });\n\n  return initialSignups;\n};\n\nexport const getSignupsPerDay = (\n  attendees: AttendeeData[],\n  eventDate: string\n) => {\n  const firstDate = getFirstDateAttendeeSignedUp(attendees);\n  const difference = moment()\n    .range(firstDate.startOf(\"day\"), moment(eventDate).startOf(\"day\"))\n    .diff(\"days\");\n\n  const attendeesWhoRSVPd = attendees.filter(attendee => attendee.didRSVP);\n\n  const initialSignups = createInitialSignups(difference, firstDate);\n\n  return attendeesWhoRSVPd.reduce((acc: any, attendee: AttendeeData) => {\n    const signupDate =\n      (attendee.rsvpDate && moment(attendee.rsvpDate)) || moment(eventDate);\n\n    const daysAfterFirstDay = moment()\n      .range(\n        moment(firstDate).startOf(\"day\"),\n        moment(signupDate).startOf(\"day\")\n      )\n      .diff(\"days\");\n\n    return {\n      ...acc,\n      [daysAfterFirstDay]: {\n        ...acc[daysAfterFirstDay],\n        count: acc[daysAfterFirstDay].count + 1,\n        attendees: [...acc[daysAfterFirstDay].attendees, attendee]\n      }\n    };\n  }, initialSignups);\n};\n\nexport const getSignupsAccumulated = (\n  attendees: AttendeeData[],\n  eventDate: string\n) => {\n  const signupsPerDay = getSignupsPerDay(attendees, eventDate);\n\n  const signupsAfterFirstDay = _.omit(signupsPerDay, \"0\");\n  const accumulatedSignUpsPerDay = _.reduce(\n    signupsAfterFirstDay,\n    (acc, day) => {\n      return {\n        ...acc,\n        [day.daysSinceFirstSignupDay]: {\n          ...day,\n          // @ts-ignore\n          count: day.count + acc[day.daysSinceFirstSignupDay - 1].count\n        }\n      };\n    },\n    { 0: signupsPerDay[\"0\"] }\n  );\n  return accumulatedSignUpsPerDay;\n};\n\nexport const getAttendanceRateBySignupDate = (\n  attendees: AttendeeData[],\n  eventDate: string\n): AttendanceRateBySignupDate => {\n  const signupsPerDay = getSignupsPerDay(attendees, eventDate);\n\n  return _.reduce(\n    signupsPerDay,\n    (days, value, key) => {\n      const attendees = value.attendees;\n\n      const initialCounts = {\n        rsvped: 0,\n        attended: 0\n      };\n\n      const attendeeSummaryPerDay = attendees.reduce(\n        (attendeeCounts: AttendeeCountsForDate, attendee: AttendeeData) => {\n          return {\n            ...attendeeCounts,\n            rsvped: attendeeCounts.rsvped + 1,\n            attended: attendee.didAttend\n              ? attendeeCounts.attended + 1\n              : attendeeCounts.attended\n          };\n        },\n        initialCounts\n      );\n\n      return {\n        ...days,\n        [key]: {\n          ...attendeeSummaryPerDay,\n          displayDate: value.displayDate\n        }\n      };\n    },\n    {}\n  );\n};\nconst sumAttendanceRates = (\n  attendance: AttendeeCountsForDate,\n  value: AttendeeCountsForDate\n): AttendeeCountsForDate => ({\n  rsvped: attendance.rsvped + value.rsvped,\n  attended: attendance.attended + value.attended\n});\n\nexport const getFirstWeekSignups = (\n  attendanceRateBySignupDate: AttendanceRateBySignupDate\n) => {\n  if (_.size(attendanceRateBySignupDate) < 7) {\n    return null;\n  }\n\n  const firstWeekAttendanceRate = _.filter(\n    attendanceRateBySignupDate,\n    (value, key) => {\n      const daysAfterFirstDay = parseInt(key);\n      return daysAfterFirstDay > 0 && daysAfterFirstDay < 7;\n    }\n  );\n  // @ts-ignore\n  return _.reduce(firstWeekAttendanceRate, sumAttendanceRates, {\n    rsvped: 0,\n    attended: 0\n  });\n};\n\nexport const getLastWeekSignups = (\n  attendanceRateBySignupDate: AttendanceRateBySignupDate\n) => {\n  const totalDays = _.size(attendanceRateBySignupDate);\n  if (totalDays < 7) {\n    return null;\n  }\n\n  const lastDay = totalDays - 1;\n\n  const firstWeekAttendanceRate = _.filter(\n    attendanceRateBySignupDate,\n    (value, key) => {\n      const daysAfterFirstDay = parseInt(key);\n      return daysAfterFirstDay > lastDay - 7;\n    }\n  );\n  // @ts-ignore\n  return _.reduce(firstWeekAttendanceRate, sumAttendanceRates, {\n    rsvped: 0,\n    attended: 0\n  });\n};\n\nexport const getAttendeesBySignupDateTable = (\n  attendanceRateBySignupDate: AttendanceRateBySignupDate\n): AttendanceBySignupDateForTable[] => {\n  return _.map(attendanceRateBySignupDate, date => {\n    return {\n      ...date,\n      percent: Math.round((date.attended / date.rsvped) * 100)\n    };\n  })\n    .filter(date => date.rsvped >= 5)\n    .sort();\n};\n"]},"metadata":{},"sourceType":"module"}